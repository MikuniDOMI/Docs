# å‡½æ•°åˆ—è¡¨

:::danger

æœ¬åº“å¤§éƒ¨åˆ†æ–¹æ³•éƒ½ä¸ºå¼‚æ­¥ï¼Œä¸”éœ€è¦ç®¡ç†å‘˜æƒé™è¿è¡Œ

:::

## ç›®å½•

- [æ ¸å¿ƒç±»](#æ ¸å¿ƒç±»)
  - [BedrockCore](#bedrockcore)
- [é…ç½®é€‰é¡¹](#é…ç½®é€‰é¡¹)
  - [CoreOptions](#coreoptions)
- [å›è°ƒä¸çŠ¶æ€](#å›è°ƒä¸çŠ¶æ€)
  - [InstallCallback](#installcallback)
  - [InstallStates](#installstates)
- [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
  - [VersionInformation](#versioninformation)
  - [VersionDetils](#versiondetils)
  - [GameBackGroundEditer](#gamebackgroundediter)
- [å·¥å…·ç±»](#å·¥å…·ç±»)
  - [FrameworkComplete.CompleteVC](#frameworkcompletecompletevc)
  - [ManifestEditor.EditManifest](#manifesteditoreditmanifest)
  - [Native æ³¨å†Œä¸å®‰è£…](#native-æ³¨å†Œä¸å®‰è£…)
- [ä¸‹è½½å™¨](#ä¸‹è½½å™¨)
  - [ImprovedFlexibleMultiThreadDownloader](#improvedflexiblemultithreaddownloader)
---

## æ ¸å¿ƒç±»

### `BedrockCore`

ä½äºå‘½åç©ºé—´ï¼š`BedrockLauncher.Core`

#### `Init()`
åˆå§‹åŒ–æ ¸å¿ƒæ¨¡å—ã€‚

> **è¯´æ˜**ï¼šå¿…é¡»åœ¨è°ƒç”¨å…¶ä»–åŠŸèƒ½å‰è°ƒç”¨æ­¤æ–¹æ³•ã€‚

```csharp
public static void Init()
```

---

#### `OpenWindowsDevelopment()`
å¼€å¯ Windows å¼€å‘è€…æ¨¡å¼ã€‚

> **æ³¨æ„**ï¼šéœ€è¦ç®¡ç†å‘˜æƒé™ã€‚

```csharp
public static void OpenWindowsDevelopment()
```

---

#### `GetWindowsDevelopmentState()`
è·å–å½“å‰ Windows å¼€å‘è€…æ¨¡å¼çŠ¶æ€ã€‚

> **è¿”å›å€¼**ï¼š
> - `true`ï¼šå·²å¼€å¯
> - `false`ï¼šæœªå¼€å¯

```csharp
public static bool GetWindowsDevelopmentState()
```

---

#### `InstallVersion(VersionInformation, string, string, InstallCallback, GameBackGroundEditer)`
å®‰è£… Minecraft æŒ‡å®šç‰ˆæœ¬ã€‚

```csharp
public static void InstallVersion(
    VersionInformation information,
    string install_dir,
    string callback,
    InstallCallback callback,
    GameBackGroundEditer gameBackGround = null
)
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `information` | `VersionInformation` | ç‰ˆæœ¬ä¿¡æ¯å¯¹è±¡ |
| `install_dir` | `string` | å®‰è£…ç›®å½•ï¼ˆç»å¯¹è·¯å¾„ï¼‰ |
| `callback` | `InstallCallback` | å®‰è£…è¿‡ç¨‹å›è°ƒ |
| `gameBackGround` | `GameBackGroundEditer` | ï¼ˆå¯é€‰ï¼‰æ¸¸æˆå¯åŠ¨èƒŒæ™¯ä¿®æ”¹è®¾ç½® |

> **æç¤º**ï¼šè‹¥ä¸æ¸…æ¥š `gameBackGround` çš„ä½œç”¨ï¼Œè¯·ä¿æŒä¸º `null`ã€‚

---

#### `ChangeVersion(string, InstallCallback)`
åˆ‡æ¢å½“å‰è¿è¡Œçš„æ¸¸æˆç‰ˆæœ¬ã€‚

```csharp
public static bool ChangeVersion(string versionPath, InstallCallback callback)
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `versionPath` | `string` | æ¸¸æˆæœ¬ä½“æ–‡ä»¶å¤¹è·¯å¾„ï¼ˆç»å¯¹è·¯å¾„ï¼‰ï¼Œéœ€åŒ…å« `AppxManifest.xml` |
| `callback` | `InstallCallback` | å›è°ƒå¯¹è±¡ï¼Œç”¨äºæ¥æ”¶è¿›åº¦ |

> **æ³¨æ„**ï¼šè°ƒç”¨ `LaunchGame` å‰åº”å…ˆè°ƒç”¨æ­¤æ–¹æ³•æŒ‡å®šç‰ˆæœ¬ã€‚

---

#### `LaunchGame(VersionType)`
å¯åŠ¨æ¸¸æˆã€‚

```csharp
public static bool LaunchGame(VersionType versionType)
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `versionType` | `VersionType` | è¦å¯åŠ¨çš„ç‰ˆæœ¬ç±»å‹ |

> **å‰æ**ï¼šå¦‚éœ€åˆ‡æ¢ç‰ˆæœ¬ï¼Œè¯·å…ˆè°ƒç”¨ `ChangeVersion`ã€‚

---

#### `StopGame()`
å…³é—­æ­£åœ¨è¿è¡Œçš„æ¸¸æˆã€‚

```csharp
public static bool StopGame()
```

> **è¿”å›å€¼**ï¼šæ˜¯å¦æˆåŠŸå…³é—­ã€‚

---

#### `RemoveGame(VersionType)`
åˆ é™¤æŒ‡å®šç‰ˆæœ¬çš„æ¸¸æˆã€‚

```csharp
public static Task<bool> RemoveGame(VersionType versionType)
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `versionType` | `VersionType` | è¦åˆ é™¤çš„ç‰ˆæœ¬ç±»å‹ |

> **è­¦å‘Š**ï¼šæ­¤æ“ä½œä¸å¯é€†ï¼Œè¯·ç¡®è®¤åå†æ‰§è¡Œã€‚

---

## é…ç½®é€‰é¡¹

### `CoreOptions`

ä½äºå‘½åç©ºé—´ï¼š`BedrockLauncher.Core.CoreOption`

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `autoOpenWindowsDevelopment` | `bool` | æ˜¯å¦è‡ªåŠ¨å¼€å¯ Windows å¼€å‘è€…æ¨¡å¼ |
| `localDir` | `string` | å®‰è£…ç›®å½•ï¼ˆç»å¯¹è·¯å¾„ï¼‰ |
| `autoCompleteVC` | `bool` | æ˜¯å¦è‡ªåŠ¨è¡¥å…¨ VC/UWP è¿è¡Œåº“ |

---

## å›è°ƒä¸çŠ¶æ€

### `InstallCallback`

ç”¨äºç›‘å¬å®‰è£…è¿‡ç¨‹ä¸­çš„è¿›åº¦ä¸ç»“æœã€‚

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `CancellationToken` | `CancellationToken` | å–æ¶ˆæ“ä½œçš„ Token |
| `downloadProgress` | `IProgress<DownloadProgress>` | ä¸‹è½½è¿›åº¦å›è°ƒ |
| `registerProcess_percent` | `Action<float>` | éƒ¨ç½²æ³¨å†Œè¿›åº¦ï¼ˆ0~100ï¼‰ |
| `result_callback` | `Action<bool, string>` | å®‰è£…ç»“æœå›è°ƒï¼ˆæˆåŠŸ/å¤±è´¥ + æ¶ˆæ¯ï¼‰ |
| `install_states` | `Action<InstallStates>` | å®‰è£…çŠ¶æ€å˜æ›´é€šçŸ¥ |

---

### `InstallStates`

è¡¨ç¤ºå®‰è£…è¿‡ç¨‹ä¸­çš„çŠ¶æ€æšä¸¾ã€‚

| å€¼ | è¯´æ˜ |
|-----|------|
| `Downloading` | æ­£åœ¨ä¸‹è½½ |
| `Extracting` | æ­£åœ¨è§£å‹ |
| `Registering` | æ­£åœ¨æ³¨å†Œåº”ç”¨ |
| `Completed` | å®‰è£…å®Œæˆ |
| `Failed` | å®‰è£…å¤±è´¥ |
| `Canceled` | ç”¨æˆ·å–æ¶ˆ |

---

## æ•°æ®æ¨¡å‹

### `VersionInformation`

æè¿°ä¸€ä¸ª Minecraft ç‰ˆæœ¬çš„åŸºæœ¬ä¿¡æ¯ã€‚

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `Type` | `string` | ç‰ˆæœ¬ç±»å‹ï¼ˆå¦‚æ­£å¼ç‰ˆã€æµ‹è¯•ç‰ˆï¼‰ |
| `ID` | `string` | ç‰ˆæœ¬å”¯ä¸€æ ‡è¯† |
| `Date` | `DateTime` | å‘å¸ƒæ—¥æœŸ |
| `Variations` | `List<VersionDetils>` | ä¸åŒæ¶æ„çš„ç‰ˆæœ¬å˜ä½“åˆ—è¡¨ |

---

### `VersionDetils`

æè¿°æŸä¸€ç‰¹å®šæ¶æ„ä¸‹çš„ç‰ˆæœ¬è¯¦æƒ…ã€‚

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `Arch` | `string` | æ¶æ„ï¼ˆå¦‚ x86, x64, ARM64ï¼‰ |
| `ArchivalStatus` | `string` | å‘å¸ƒçŠ¶æ€ï¼ˆå¦‚ Active, Deprecatedï¼‰ |
| `OSbuild` | `int` | æ‰€éœ€æœ€ä½ Windows æ„å»ºå· |
| `UpdateIds` | `List<string>` | å…³è”çš„ Update ID åˆ—è¡¨ |
| `MD5` | `string` | æ–‡ä»¶çš„ MD5 æ ¡éªŒå€¼ |

---

### `GameBackGroundEditer`

ç”¨äºä¿®æ”¹æ¸¸æˆå¯åŠ¨ç”»é¢èƒŒæ™¯ã€‚

| å­—æ®µ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `file` | `string` | èƒŒæ™¯å›¾ç‰‡æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ |
| `color` | `string` | èƒŒæ™¯é¢œè‰²ï¼ˆHex 16è¿›åˆ¶ï¼Œå¦‚ `#FF0000`ï¼‰ |
| `isOpen` | `bool` | æ˜¯å¦å¯ç”¨è‡ªå®šä¹‰èƒŒæ™¯åŠŸèƒ½ |

> **è­¦å‘Š**ï¼šä¿®æ”¹æ­¤è®¾ç½®å¯èƒ½å½±å“å¯åŠ¨ç¨³å®šæ€§ã€‚

---

## å·¥å…·ç±»

### `FrameworkComplete.CompleteVC`

è‡ªåŠ¨è¡¥å…¨ VC++ å’Œ UWP è¿è¡Œåº“ä¾èµ–ã€‚

```csharp
public static async Task CompleteVC()
```

> **å¼‚å¸¸**ï¼šè‹¥å®‰è£…å¤±è´¥ä¼šæŠ›å‡º `System.Exception`ã€‚
> **è¡Œä¸º**ï¼šå¦‚æœæ‰€éœ€è¿è¡Œåº“å·²å­˜åœ¨ï¼Œåˆ™è·³è¿‡å®‰è£…ã€‚

---

### `ManifestEditor.EditManifest`

ä¿®æ”¹ `AppxManifest.xml` å¹¶æ·»åŠ è‡ªå®šä¹‰èƒ½åŠ›æ–‡ä»¶ï¼ˆCustomCapability.SCCDï¼‰ã€‚

```csharp
public static bool EditManifest(string manifestPath, GameBackGroundEditer backgroundEditor)
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `manifestPath` | `string` | `AppxManifest.xml` æ–‡ä»¶è·¯å¾„ |
| `backgroundEditor` | `GameBackGroundEditer` | èƒŒæ™¯ç¼–è¾‘é…ç½® |

> **è¿”å›å€¼**ï¼š
> - `true`ï¼šä¿®æ”¹æˆåŠŸ
> - `false`ï¼šå¤±è´¥ï¼ˆå¦‚æ–‡ä»¶ä¸å­˜åœ¨æˆ–æƒé™ä¸è¶³ï¼‰

---

### Native æ³¨å†Œä¸å®‰è£…

ä½äºå‘½åç©ºé—´ï¼š`BedrockLauncher.Core.Native`

#### `RegisterAppxAsync`

å¼‚æ­¥æ³¨å†Œ AppX åŒ…ï¼ˆä¸»ç¨‹åºåŒ…ï¼‰ã€‚

```csharp
public static void RegisterAppxAsync(
    string appxXmlpath,
    Action<IAsyncOperationWithProgress<DeploymentResult, DeploymentProgress>, DeploymentProgress> ProgressCallAction,
    Action<IAsyncOperationWithProgress<DeploymentResult, DeploymentProgress>, AsyncStatus> completeAction
)
```

| å‚æ•° | è¯´æ˜ |
|------|------|
| `appxXmlpath` | `AppxManifest.xml` æ‰€åœ¨è·¯å¾„ |
| `ProgressCallAction` | è¿›åº¦å›è°ƒ |
| `completeAction` | å®Œæˆå›è°ƒï¼ˆæˆåŠŸ/å¤±è´¥/å–æ¶ˆï¼‰ |

> **æç¤º**ï¼šå»ºè®®ä½¿ç”¨ `TaskCompletionSource` åŒ…è£…ä»¥æ”¯æŒ `await`ã€‚

---

#### `addAppxAsync`

å¼‚æ­¥æ·»åŠ æ¡†æ¶ç±» AppX åŒ…ï¼ˆå¦‚è¿è¡Œåº“ï¼‰ã€‚

```csharp
public static void addAppxAsync(
    string appxPath,
    Action<IAsyncOperationWithProgress<DeploymentResult, DeploymentProgress>, DeploymentProgress> ProgressCallAction,
    Action<IAsyncOperationWithProgress<DeploymentResult, DeploymentProgress>, AsyncStatus> completeAction
)
```

| å‚æ•° | è¯´æ˜ |
|------|------|
| `appxPath` | `.appx` æˆ– `.msix` æ–‡ä»¶è·¯å¾„ |
| `ProgressCallAction` | éƒ¨ç½²è¿›åº¦å›è°ƒ |
| `completeAction` | å®ŒæˆçŠ¶æ€å›è°ƒ |

---

## ä¸‹è½½å™¨

### `ImprovedFlexibleMultiThreadDownloader`

é«˜æ€§èƒ½å¤šçº¿ç¨‹ä¸‹è½½å™¨ï¼Œæ”¯æŒæ–­ç‚¹ç»­ä¼ ï¼ˆè‹¥æœåŠ¡å™¨æ”¯æŒï¼‰ã€‚

#### æ„é€ å‡½æ•°

```csharp
public ImprovedFlexibleMultiThreadDownloader(int maxConcurrency, int bufferSize, int defaultTimeoutSeconds = 100)
```

| å‚æ•° | è¯´æ˜ |
|------|------|
| `maxConcurrency` | æœ€å¤§å¹¶å‘çº¿ç¨‹æ•°ï¼ˆæ¨è 4~8ï¼‰ |
| `bufferSize` | æ¯æ¬¡è¯»å†™ç¼“å†²åŒºå¤§å°ï¼ˆå­—èŠ‚ï¼‰ |
| `defaultTimeoutSeconds` | å•ä¸ªè¯·æ±‚è¶…æ—¶æ—¶é—´ï¼ˆç§’ï¼Œé»˜è®¤ 100ï¼‰ |

---

#### `DownloadAsync`

æ‰§è¡Œå¼‚æ­¥ä¸‹è½½ä»»åŠ¡ã€‚

```csharp
public async Task<bool> DownloadAsync(
    string url,
    string filePath,
    IProgress<DownloadProgress> progress = null,
    CancellationToken cancellationToken = default
)
```

| å‚æ•° | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `url` | `string` | ä¸‹è½½æ–‡ä»¶çš„ URL |
| `filePath` | `string` | æœ¬åœ°ä¿å­˜è·¯å¾„ |
| `progress` | `IProgress<DownloadProgress>` | ä¸‹è½½è¿›åº¦å›è°ƒ |
| `cancellationToken` | `CancellationToken` | æ”¯æŒå–æ¶ˆä¸‹è½½ |

> **è¿”å›å€¼**ï¼š
> - `true`ï¼šä¸‹è½½æˆåŠŸ
> - `false`ï¼šå¤±è´¥ï¼ˆç½‘ç»œé”™è¯¯ã€å–æ¶ˆã€æ ¡éªŒå¤±è´¥ç­‰ï¼‰

---

#### `DownloadProgress`

æä¾›ä¸‹è½½è¿›åº¦ä¿¡æ¯ã€‚

| å±æ€§ | ç±»å‹ | è¯´æ˜ |
|------|------|------|
| `TotalBytes` | `long` | æ€»å¤§å°ï¼ˆæœªçŸ¥æ—¶ä¸º -1ï¼‰ |
| `DownloadedBytes` | `long` | å·²ä¸‹è½½å­—èŠ‚æ•° |
| `ProgressPercentage` | `int` | è¿›åº¦ç™¾åˆ†æ¯”ï¼ˆ0~100ï¼ŒæœªçŸ¥æ—¶ä¸º -1ï¼‰ |

---

## ä½¿ç”¨ç¤ºä¾‹

### å®‰è£…æœ€æ–°ç‰ˆæœ¬

```csharp
var versionInfo = new VersionInformation {
    ID = "1.20.10",
    Type = "Release",
    Variations = new List<VersionDetils> {
        new VersionDetils {
            Arch = "x64",
            OSbuild = 19041,
            UpdateIds = new List<string> { "Microsoft.MinecraftUWP_8wekyb3d8bbwe" },
            MD5 = "a1b2c3..."
        }
    }
};

var callback = new InstallCallback {
    downloadProgress = new Progress<DownloadProgress>(progress => {
        Console.WriteLine($"ä¸‹è½½: {progress.ProgressPercentage}%");
    }),
    registerProcess_percent = percent => {
        Console.WriteLine($"éƒ¨ç½²: {percent}%");
    },
    result_callback = (success, msg) => {
        Console.WriteLine(success ? "å®‰è£…æˆåŠŸ" : $"å¤±è´¥: {msg}");
    },
    install_states = state => {
        Console.WriteLine($"çŠ¶æ€: {state}");
    }
};

await BedrockCore.InstallVersion(versionInfo, @"C:\MC\Versions\1.20.10", callback);
```

---

## æ³¨æ„äº‹é¡¹

- æ‰€æœ‰æ¶‰åŠ UWP å®‰è£…çš„æ“ä½œå‡éœ€ **ç®¡ç†å‘˜æƒé™**ã€‚
- ä¿®æ”¹ `AppxManifest.xml` å¯èƒ½å¯¼è‡´ç­¾åå¤±æ•ˆï¼Œéœ€é‡æ–°æ³¨å†Œã€‚
- `GameBackGroundEditer` åŠŸèƒ½å®éªŒæ€§è¾ƒå¼ºï¼Œå»ºè®®è°¨æ…ä½¿ç”¨ã€‚
- æ¨èåœ¨è°ƒç”¨ `Init()` åæ£€æŸ¥ `CoreOptions` è®¾ç½®ã€‚

---

## ç‰ˆæœ¬å…¼å®¹æ€§

- æ”¯æŒ Windows 10 / 11ï¼ˆBuild 19041 åŠä»¥ä¸Šï¼‰
- .NET 5 æˆ– .NET Framework 4.8+
- éœ€å¯ç”¨å¼€å‘è€…æ¨¡å¼ï¼ˆæˆ–è‡ªåŠ¨å¼€å¯ï¼‰

---

> ğŸ“„ æ–‡æ¡£ç‰ˆæœ¬ï¼š1.0  
> Â© 2025 BedrockLauncher Team. ä¿ç•™æ‰€æœ‰æƒåˆ©ã€‚

--- 

ä½ å¯ä»¥å°†æ­¤ `.md` æ–‡ä»¶æ”¾å…¥é¡¹ç›®çš„ `docs/` ç›®å½•ä¸­ï¼Œé…åˆ GitHub Pages æˆ– DocFx ä½¿ç”¨ï¼Œç”Ÿæˆç¾è§‚çš„åœ¨çº¿æ–‡æ¡£ã€‚éœ€è¦æˆ‘å¸®ä½ ç”Ÿæˆ HTML æˆ–æ·»åŠ å¯¼èˆªç»“æ„å—ï¼Ÿ